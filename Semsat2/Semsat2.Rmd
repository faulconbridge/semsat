Semantic Satiation among Lexically Ambiguous Words: Experiment 2
================================================================

Acquiring the Data
------------------

We will first download the raw CSV from github and do a bit of preprocessing on it:

```{r}
download.file("https://github.com/faulconbridge/semsat/raw/master/Semsat2/Semsat2_compiled.csv", "semsat2.csv", "wget", extra="--no-check-certificate")
  semsat2 <- read.csv("semsat2.csv",header=TRUE,sep=",")

raw <- semsat2

# Specify which variables should be treated as factors
raw <- within(raw, {
  BIAS <- factor(BIAS)
  HomType <- factor(HomType)
  REPS <- factor(REPS)
  PID <- factor(PID)
  STDEV <- MS.3.STDEV
  IQR <- MS.IQR
})

# Strip out all filler and incorrectly-answered items
raw <- subset(raw, (BIAS=="dominant" & ANSWER=="M") |
                (BIAS=="subordinate" & ANSWER=="M") |
                (BIAS=="unrelated" & (HomType=="NV" | HomType=="NN")
                 & ANSWER=="C"),
              select=c(PID,BIAS,HomType,REPS,
                       ANSWER,MS,STDEV,IQR))

# Strip out participants who encountered bugs during the experiment
raw <- subset(raw, PID!=57 | PID!=42 | PID!=14,
              select=c(PID,BIAS,HomType,REPS,
                       ANSWER,MS,STDEV,IQR))

# Subset data to include untrimmed MS response times
raw.MS <- subset(raw,select=c(PID:MS))
raw.MS <- na.omit(raw.MS)

# Take the participant average RTs for each condition
raw.mean.MS <- aggregate(raw.MS$MS,
                      by=list(raw.MS$PID,raw.MS$BIAS,
                              raw.MS$HomType,raw.MS$REPS),
                      FUN='mean')
colnames(raw.mean.MS) <- c("PID","BIAS","HomType","REPS","MS")

# Subset the data to remove outliers beyond +-3 sd
raw.stdev <- subset(raw, select=c(PID,BIAS,HomType,REPS,STDEV))
raw.stdev <- na.omit(raw.stdev)

# Take the participant average RTs for each condition

raw.mean.stdev <- aggregate(raw.stdev$STDEV,
                      by=list(raw.stdev$PID,raw.stdev$BIAS,
                              raw.stdev$HomType,raw.stdev$REPS),
                      FUN='mean')
colnames(raw.mean.stdev) <- c("PID","BIAS","HomType","REPS","STDEV")

# Subset the data to remove outliers 1.5x IQR beyond Q1 or Q3
raw.IQR <- subset(raw, select=c(PID,BIAS,HomType,REPS,IQR))
raw.IQR <- na.omit(raw.IQR)

# Take the participant average RTs for each condition
raw.mean.IQR <- aggregate(raw.IQR$IQR,
                      by=list(raw.IQR$PID,raw.IQR$BIAS,
                              raw.IQR$HomType,raw.IQR$REPS),
                      FUN='mean')
colnames(raw.mean.IQR) <- c("PID","BIAS","HomType","REPS","IQR")
```

Performing the Analyses
-----------------------
First we can look at the untrimmed data:
```{r,echo=1,results='asis'}
raw.aov <- aov(MS ~ BIAS*HomType*REPS+Error(PID),
               data=raw.mean.MS)
library(xtable)
library(nlme)
library(multcomp)
print(xtable(summary(raw.aov)),type="html")
```

Then trimming based on standard deviations:
```{r,echo=1,results='asis'}
stdev.aov <- aov(STDEV ~ BIAS*HomType*REPS+Error(PID),
                     data=raw.mean.stdev)
print(xtable(summary(stdev.aov)),type="html")
```

And finally based on interquatrile range:
```{r,echo=1,results='asis'}
iqr.aov <- aov(IQR ~ BIAS*HomType*REPS+Error(PID),
                     data=raw.mean.IQR)
print(xtable(summary(iqr.aov)),type="html")
```

Now we will perform a test on the three-way BIAS x HomType x REPS interaction:
```{r}
raw.mean.stdev$BHR <- with(raw.mean.stdev,interaction(BIAS,HomType,REPS,sep="x"))

raw.mean.stdev$BHR <- factor(raw.mean.stdev$BHR)

stdev.lme <- lme(STDEV~BHR, random=~1|PID, data=raw.mean.stdev)

l2 <- glht(stdev.lme,linfct = mcp(BHR = "Tukey"))
summary(l2)
```

Or, more compactly:

<img src="https://raw.githubusercontent.com/faulconbridge/semsat/master/Semsat2/figure/Tukey.png" />